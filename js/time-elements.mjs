var v=class{constructor(){this._cache=new Map}_genFormatter(e){let t=new Intl.DateTimeFormat(e,{dateStyle:"full",timeStyle:"short"}),n=new Intl.DateTimeFormat(e,{dateStyle:"full",timeStyle:"full"});return{text:t,title:n}}getFormatter(e){let t=e,n=this._cache.get(t);return n===void 0&&(n=this._genFormatter(e),this._cache.set(t,n)),n}},_=new v,g=class extends HTMLElement{constructor(){super(...arguments);this.locales=navigator.language;this.date=new Date;this._effect_lock=!1}static get observedAttributes(){return["datetime","locales"]}attributeChangedCallback(e,t,n){if(e==="datetime"){let a=Date.parse(n);if(isNaN(a))return;this.date=new Date(a)}this._doEffectAttributes()}_doEffectAttributes(){this._effect_lock||(this._effect_lock=!0,queueMicrotask(()=>{let e=_.getFormatter(this.locales);this.textContent=e.text.format(this.date),this.title=e.title.format(this.date),this._effect_lock=!1}))}};window.customElements.get("local-time")||(Reflect.set(window,"LocalTimeElement",g),window.customElements.define("local-time",g));var y=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],w=["January","February","March","April","May","June","July","August","September","October","November","December"];function c(r){return`0${r}`.slice(-2)}function T(r,e){let t=r.getDay(),n=r.getDate(),a=r.getMonth(),i=r.getFullYear(),s=r.getHours(),l=r.getMinutes(),h=r.getSeconds();return e.replace(/%([%aAbBcdeHIlmMpPSwyYZz])/g,function(A){let f;switch(A[1]){case"%":return"%";case"a":return y[+t%y.length].slice(0,3);case"A":return y[+t%y.length];case"b":return w[+a%w.length].slice(0,3);case"B":return w[+a%w.length];case"c":return r.toString();case"d":return c(n);case"e":return String(n);case"H":return c(s);case"I":return c(T(r,"%l"));case"l":return String(s===0||s===12?12:(s+12)%12);case"m":return c(a+1);case"M":return c(l);case"p":return s>11?"PM":"AM";case"P":return s>11?"pm":"am";case"S":return c(h);case"w":return String(t);case"y":return c(i%100);case"Y":return String(i);case"Z":return f=r.toString().match(/\((\w+)\)$/),f?.[1]||"";case"z":return f=r.toString().match(/\w([+-]\d\d\d\d) /),f?.[1]||""}return""})}function m(r){let e;return function(){if(e)return e;if("Intl"in window)try{return e=new Intl.DateTimeFormat(void 0,r),e}catch(t){if(!(t instanceof RangeError))throw t}}}var M=null,C=m({day:"numeric",month:"short"});function x(){if(M!==null)return M;let r=C();return r?(M=!!r.format(new Date(0)).match(/^\d/),M):!1}var F=null,L=m({day:"numeric",month:"short",year:"numeric"});function k(){if(F!==null)return F;let r=L();return r?(F=!!r.format(new Date(0)).match(/\d,/),F):!0}function S(r){return new Date().getUTCFullYear()===r.getUTCFullYear()}function I(r,e){if("Intl"in window&&"RelativeTimeFormat"in window.Intl)try{return new Intl.RelativeTimeFormat(r,e)}catch(t){if(!(t instanceof RangeError))throw t}}function $(r){let e=r.closest("[lang]");return e instanceof HTMLElement&&e.lang?e.lang:"default"}var p=class{constructor(e,t){this.date=e,this.locale=t}toString(){let e=this.timeElapsed();if(e)return e;{let t=this.timeAhead();return t||`on ${this.formatDate()}`}}timeElapsed(){let e=new Date().getTime()-this.date.getTime(),t=Math.round(e/1e3),n=Math.round(t/60),a=Math.round(n/60),i=Math.round(a/24);return e>=0&&i<30?this.timeAgoFromMs(e):null}timeAhead(){let e=this.date.getTime()-new Date().getTime(),t=Math.round(e/1e3),n=Math.round(t/60),a=Math.round(n/60),i=Math.round(a/24);return e>=0&&i<30?this.timeUntil():null}timeAgo(){let e=new Date().getTime()-this.date.getTime();return this.timeAgoFromMs(e)}timeAgoFromMs(e){let t=Math.round(e/1e3),n=Math.round(t/60),a=Math.round(n/60),i=Math.round(a/24),s=Math.round(i/30),l=Math.round(s/12);return e<0?o(this.locale,0,"second"):t<10?o(this.locale,0,"second"):t<45?o(this.locale,-t,"second"):t<90?o(this.locale,-n,"minute"):n<45?o(this.locale,-n,"minute"):n<90?o(this.locale,-a,"hour"):a<24?o(this.locale,-a,"hour"):a<36?o(this.locale,-i,"day"):i<30?o(this.locale,-i,"day"):s<18?o(this.locale,-s,"month"):o(this.locale,-l,"year")}microTimeAgo(){let e=new Date().getTime()-this.date.getTime(),t=Math.round(e/1e3),n=Math.round(t/60),a=Math.round(n/60),i=Math.round(a/24),s=Math.round(i/30),l=Math.round(s/12);return n<1?"1m":n<60?`${n}m`:a<24?`${a}h`:i<365?`${i}d`:`${l}y`}timeUntil(){let e=this.date.getTime()-new Date().getTime();return this.timeUntilFromMs(e)}timeUntilFromMs(e){let t=Math.round(e/1e3),n=Math.round(t/60),a=Math.round(n/60),i=Math.round(a/24),s=Math.round(i/30),l=Math.round(s/12);return s>=18?o(this.locale,l,"year"):s>=12?o(this.locale,l,"year"):i>=45?o(this.locale,s,"month"):i>=30?o(this.locale,s,"month"):a>=36?o(this.locale,i,"day"):a>=24?o(this.locale,i,"day"):n>=90?o(this.locale,a,"hour"):n>=45?o(this.locale,a,"hour"):t>=90?o(this.locale,n,"minute"):t>=45?o(this.locale,n,"minute"):t>=10?o(this.locale,t,"second"):o(this.locale,0,"second")}microTimeUntil(){let e=this.date.getTime()-new Date().getTime(),t=Math.round(e/1e3),n=Math.round(t/60),a=Math.round(n/60),i=Math.round(a/24),s=Math.round(i/30),l=Math.round(s/12);return i>=365?`${l}y`:a>=24?`${i}d`:n>=60?`${a}h`:n>1?`${n}m`:"1m"}formatDate(){let e=x()?"%e %b":"%b %e";return S(this.date)||(e+=k()?", %Y":" %Y"),T(this.date,e)}formatTime(){let e=H();return e?e.format(this.date):T(this.date,"%l:%M%P")}};function o(r,e,t){let n=I(r,{numeric:"auto"});return n?n.format(e,t):Y(e,t)}function Y(r,e){if(r===0)switch(e){case"year":case"quarter":case"month":case"week":return`this ${e}`;case"day":return"today";case"hour":case"minute":return`in 0 ${e}s`;case"second":return"now"}else if(r===1)switch(e){case"year":case"quarter":case"month":case"week":return`next ${e}`;case"day":return"tomorrow";case"hour":case"minute":case"second":return`in 1 ${e}`}else if(r===-1)switch(e){case"year":case"quarter":case"month":case"week":return`last ${e}`;case"day":return"yesterday";case"hour":case"minute":case"second":return`1 ${e} ago`}else if(r>1)switch(e){case"year":case"quarter":case"month":case"week":case"day":case"hour":case"minute":case"second":return`in ${r} ${e}s`}else if(r<-1)switch(e){case"year":case"quarter":case"month":case"week":case"day":case"hour":case"minute":case"second":return`${-r} ${e}s ago`}throw new RangeError(`Invalid unit argument for format() '${e}'`)}var H=m({hour:"numeric",minute:"2-digit"});var E=new WeakMap,D=class extends HTMLElement{static get observedAttributes(){return["datetime","day","format","lang","hour","minute","month","second","title","weekday","year","time-zone-name"]}connectedCallback(){let e=this.getFormattedTitle();e&&!this.hasAttribute("title")&&this.setAttribute("title",e);let t=this.getFormattedDate();t&&(this.textContent=t)}attributeChangedCallback(e,t,n){let a=this.getFormattedTitle();if(e==="datetime"){let h=Date.parse(n);isNaN(h)?E.delete(this):E.set(this,new Date(h))}let i=this.getFormattedTitle(),s=this.getAttribute("title");e!=="title"&&i&&(!s||s===a)&&this.setAttribute("title",i);let l=this.getFormattedDate();l&&(this.textContent=l)}get date(){return E.get(this)}getFormattedTitle(){let e=this.date;if(!e)return;let t=N();if(t)return t.format(e);try{return e.toLocaleString()}catch(n){if(n instanceof RangeError)return e.toString();throw n}}getFormattedDate(){}},N=m({day:"numeric",month:"short",year:"numeric",hour:"numeric",minute:"2-digit",timeZoneName:"short"});var b=class extends D{getFormattedDate(){let e=this.date;if(!!e)return new p(e,$(this)).toString()}connectedCallback(){u.push(this),d||(R(),d=window.setInterval(R,60*1e3)),super.connectedCallback()}disconnectedCallback(){let e=u.indexOf(this);e!==-1&&u.splice(e,1),u.length||d&&(clearInterval(d),d=null)}},u=[],d;function R(){for(let r of u)r.textContent=r.getFormattedDate()||""}window.customElements.get("relative-time")||(window.RelativeTimeElement=b,window.customElements.define("relative-time",b));export{g as LocalTimeElement,b as RelativeTimeElement};
