<!doctype html><html><head><meta charset="utf-8"><meta name="description" content=""><meta name="keywords" content="Appn, WebComponent, article"><meta name="author" content="Gaubee, gaubeebangeel@gmail.com"><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=5"><title>MVVM框架中关于状态机的概念与实现动机</title><link rel="shortcut icon" href="/assets/favicon-wB3RD3gX.ico"><link rel="stylesheet" href="/index.css">  <link rel="stylesheet" crossorigin href="/assets/prism-okaidia-D95GE6Gn.css">
</head><body><header class="bg-ani"><style>.nav{padding:0 2em;border-radius:2em;backdrop-filter:contrast(0.5) brightness(2);width:fit-content;max-width:100%}.nav{display:grid;grid-template-columns:repeat(auto-fit,180px);justify-content:center;gap:12px}.nav>a{display:block;flex:1;font-size:18px;padding:16px;text-align:center}.nav>a{color:#e91e63}@supports (-webkit-background-clip:text){.nav>a{background:-webkit-linear-gradient(#e91e63,#673ab7);color:transparent;-webkit-background-clip:text;-webkit-text-fill-color:transparent}}</style><nav class="nav"><a class="" href="/">Home</a> <a class="target" href="/articles/">Articles</a> <a class="" href="/events/">Events</a> <a class="" href="/timeline/">Timeline</a> <a class="" href="/projects/">Projects</a></nav></header><div id="main-wrapper" class="article-wrapper"><main><h1>MVVM框架中关于状态机的概念与实现动机</h1><p>状态机是目前库中所存在的一个高级的概念，它一定程度上是现有功能的一个组合，使用字符串指令针对状态机的操作，以下是其运作流程：</p><pre><code>绑定一个事件
    -&gt; 这个事件是一个命令，目前有四种基础命令：
       （赋值）=，（添加）+，（移除）-，（切换）?
            -&gt; 事件触发，动态解析命令对状态机进行相应的操作
               （某种程度上就限制了效率的保证）
</code></pre><p>这四个基础命令都是统一的格式：双目运算符的格式。 左边的参数是目标key，字符串类型，所以这是可动态的：</p><pre><code>{{&quot; {{key}} = {{&quot;static value&quot;}} &quot;}}
</code></pre><p>可以看到一个命令是一个字符串，而后两个参数都需要用<code>{{}}</code>进行包裹，其中第一个参数作为目标key，第二个参数是赋值内容，在源码不到白行的实现中也是很明了的知道其命令最终编译出来的代码是：</p><pre><code>key = VI.get(key);
value = &quot;static value&quot;;

VI.set(key,value);
</code></pre><p>再来一个例子：</p><pre><code>{{&quot; {{&quot;key&quot;}} = {{value}} &quot;}}
//==&gt;
key = &quot;key&quot;;
value = VI.get(&quot;value&quot;);

VI.set(key,value);
</code></pre><p>在状态机的操作中，两个参数都可以是动态的，就造就了状态机操作这个功能的灵巧与强大。比如一套操作中切换一个状态机，就可以把所有的操作换一个目标换一个效果。如果配合DOM的className进行使用能有什么效果，你懂的。</p><p>然而，状态机强化了View层的功能，我依然不建议把变化大的业务功能放到这块中，如果你不怕被团队的人吐槽的话（××的改个代码还要跑到View层改！！）</p><p>不过这个功能用来写Weight还是很方便的，毕竟Weight中变动的是数据而不是Weight自有的逻辑（好吧我最原始的目的暴露出来的……呵呵）</p></main></div><style>footer a{line-height:1}footer nav{display:flex;gap:1rem}</style><footer class="bg-ani"><nav><a target="_blank" href="https://github.com/gaubee/gaubee.com">Github</a> <a target="_blank" href="https://beian.miit.gov.cn/#/Integrated/recordQuery">闽ICP备17026139号-1</a></nav></footer></body></html>