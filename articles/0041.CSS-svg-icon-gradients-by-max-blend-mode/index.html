<!doctype html><html><head><meta charset="utf-8"><meta name="description" content=""><meta name="keywords" content="Appn, WebComponent, article"><meta name="author" content="Gaubee, gaubeebangeel@gmail.com"><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=5"><title>CSS“文字”渐变，一种比background-clip通用性更好的方案，可以用于SVG中（CSS svg icon gradients, a more versatile solution than background-clip）</title><link rel="shortcut icon" href="/assets/favicon-wB3RD3gX.ico"><link rel="stylesheet" href="/index.css">  <script type="module" crossorigin src="/assets/index-Bv7vwZfi.js"></script>
  <link rel="modulepreload" crossorigin href="/assets/custom-element-5yw23DFW-u-fv7RTc.js">
  <link rel="stylesheet" crossorigin href="/assets/prism-okaidia-D95GE6Gn.css">
</head><body><header class="bg-ani"><style>.nav{padding:0 2em;border-radius:2em;backdrop-filter:contrast(0.5) brightness(2);width:fit-content;max-width:100%}.nav{display:grid;grid-template-columns:repeat(auto-fit,180px);justify-content:center;gap:12px}.nav>a{display:block;flex:1;font-size:18px;padding:16px;text-align:center}.nav>a{color:#e91e63}@supports (-webkit-background-clip:text){.nav>a{background:-webkit-linear-gradient(#e91e63,#673ab7);color:transparent;-webkit-background-clip:text;-webkit-text-fill-color:transparent}}</style><nav class="nav"><a class="" href="/">Home</a> <a class="target" href="/articles/">Articles</a> <a class="" href="/events/">Events</a> <a class="" href="/timeline/">Timeline</a> <a class="" href="/projects/">Projects</a></nav></header><div id="main-wrapper" class="article-wrapper"><main><h1>CSS“文字”渐变，一种比background-clip通用性更好的方案，可以用于SVG中（CSS svg icon gradients, a more versatile solution than background-clip）</h1><h2>示例 Demo</h2><p><com-mix-blend-mode-gradient-text></com-mix-blend-mode-gradient-text></p><h2>起因 The Story</h2><p>探究这个问题的起因，是源于我打算把公司的图标从 font 逐步转化成 svg。</p><blockquote><p>My plan is convert the company's icon from font to svg gradually.</p></blockquote><p>虽然绘制性能有所下降，但是整体的好处是比 font 多得多的：比如“按需引入”，“多色”，“动画”，“可访问性”等等。</p><blockquote><p>Although the drawing performance maybe reduced, the overall benefits are much more than font: &quot;dynamic import&quot;, &quot;multi-color&quot;, &quot;animation&quot;, &quot;accessibility&quot;, etc.</p></blockquote><p>但之前使用<code>background-clip:text</code>的方案就不好用了，因为默认情况下，svg 的 path 使用的是<code>fill=&quot;currentColor&quot;</code>这样的写法。诸多原因，我不得不思考较好的替代的方案。</p><blockquote><p>But the previous solution of using <code>background-clip:text</code> doesn't work well, because by default, svg's path use <code>fill=&quot;currentColor&quot;</code>. For many reasons, I had to think of a better alternative.</p></blockquote><h2>做法 Usage</h2><p>核心思路是使用<code>mix-blend-mode</code>。</p><blockquote><p>The core idea is to use <code>mix-blend-mode</code>.</p></blockquote><pre class="language-html"><code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>gradient-text<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>SOME TEXT<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span></code></pre><pre class="language-css"><code class="language-css"><span class="token selector">body</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--bg-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.gradient-text</span> <span class="token punctuation">{</span>
  <span class="token property">background</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--gradient-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">color</span><span class="token punctuation">:</span> <span class="token function">var</span><span class="token punctuation">(</span>--bg-color<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> relative<span class="token punctuation">;</span>
  <span class="token property">mix-blend-mode</span><span class="token punctuation">:</span> difference<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector">.gradient-text::before</span> <span class="token punctuation">{</span>
  <span class="token property">content</span><span class="token punctuation">:</span> <span class="token string">' '</span><span class="token punctuation">;</span>
  <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>
  <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>
  <span class="token property">top</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">left</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">right</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>
  <span class="token property">background</span><span class="token punctuation">:</span> inherit<span class="token punctuation">;</span>
  <span class="token property">mix-blend-mode</span><span class="token punctuation">:</span> difference<span class="token punctuation">;</span>
  <span class="token property">pointer-events</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre><h2>原理 Principle</h2><p>DEMO 中，一共有三层定义：</p><ol><li><code>body</code>：我们称之为 <code>TOP-LAYER-0</code> ；</li><li><code>.gradient-text</code>：我们称之为 <code>CONTENT-LAYER-1</code> ，它由两部分组成：<ol><li><code>CONTENT-BG-1</code> ：绘制着我们定义的<code>var(--gradient-color)</code></li><li><code>CONTENT-INNER-2</code> ：绘制着我们的文本、svg 等内容</li></ol></li><li><code>.gradient-text::before</code>：我们称之为 <code>TOP-LAYER-3</code> ；</li></ol><blockquote><p>In Demo, There are three layers defined:</p><ol><li><code>body</code>: we call it <code>TOP-LAYER-0</code>;</li><li><code>.gradient-text</code>: we call it &quot;<code>CONTENT-LAYER-1</code>&quot; and it consists of two parts:<ol><li>&quot;<code>CONTENT-BG-1</code>&quot;: draws the <code>var(--gradient-color)</code> we defined</li><li>&quot;<code>CONTENT-INNER-2</code>&quot;: drawing our text, svg, etc.</li></ol></li><li><code>.gradient-text::before</code>: we call it <code>TOP-LAYER-3</code>；</li></ol></blockquote><p>所以这里总共有四种景受到影响，我们可以逐一推理每一种景发生的混合：</p><blockquote><p>So there are a total of four layer affected here, and we can reason about the mix one by one.</p></blockquote><ol><li><code>TOP-LAYER-0-RES</code> = <code>TOP-LAYER-0</code> ^ <code>CONTENT-BG-1</code> ^ <code>TOP-LAYER-3</code>；<ol><li>∵ <code>CONTENT-BG-1</code> == <code>TOP-LAYER-3</code></li><li>∴ <code>TOP-LAYER-0-RES</code> = <code>TOP-LAYER-0</code></li></ol></li><li><code>CONTENT-BG-1-RES</code> = <code>TOP-LAYER-0</code> ^ <code>CONTENT-BG-1</code> ^ <code>TOP-LAYER-3</code><ol><li>∵ <code>CONTENT-BG-1</code> ^ <code>TOP-LAYER-3</code></li><li>∴ <code>CONTENT-BG-1-RES</code> = <code>TOP-LAYER-0</code></li></ol></li><li><code>CONTENT-INNER-2-RES</code> = <code>TOP-LAYER-0</code> ^ <code>CONTENT-INNER-2</code> ^ <code>TOP-LAYER-3</code><ol><li>∵ <code>TOP-LAYER-0</code> == <code>CONTENT-INNER-2</code></li><li>∴ <code>CONTENT-INNER-2-RES</code> = <code>TOP-LAYER-3</code></li></ol></li><li><code>TOP-LAYER-3-RES</code> = <code>TOP-LAYER-0</code> ^ <code>CONTENT-BG-1</code> ^ <code>TOP-LAYER-3</code><ol><li>∵ <code>CONTENT-BG-1</code> == <code>TOP-LAYER-3</code></li><li>∴ <code>TOP-LAYER-3-RES</code> = <code>TOP-LAYER-0</code></li></ol></li></ol><p>可以看到， <code>TOP-LAYER-0-RES</code> 、 <code>CONTENT-BG-1-RES</code> 、 <code>TOP-LAYER-3-RES</code> 最终都等于 <code>TOP-LAYER-0</code> ，所以它们看上去跟直接看到 <code>TOP-LAYER-0</code> 的效果一样。像是透明层一般。</p><blockquote><p>As you can see, <code>TOP-LAYER-0-RES</code>, <code>CONTENT-BG-1-RES</code>, and <code>TOP-LAYER-3-RES</code> end up being equal to <code>TOP-LAYER-0</code>, so they look the same as if you see <code>TOP-LAYER-0</code> directly. It looks like a transparent layer.</p></blockquote><p>只剩下 <code>CONTENT-INNER-2-RES</code> 绘制的是 <code>TOP-LAYER-3</code> 的内容，也就是我们最终需要的渐变色。</p><blockquote><p>Only <code>CONTENT-INNER-2-RES</code> is left to draw the contents of <code>TOP-LAYER-3</code>, which is the gradient color we eventually need.</p></blockquote><h2>缺陷 Defects</h2><ol><li>因为使用混合模式，它需要小心元素所在的父级。如果父级是一个复杂的图层，比如有复杂的背景，那么这个方案就无法生效了。所以父级最好是白色或者黑色</li></ol><blockquote><ol><li>Because using blend mode, it needs to be careful about the parent layer where the element is located. If the parent is a complex layer, for example with a complex background, then this scheme will not work. so the parent layer should preferably be white or black.</li></ol></blockquote><ol start="2"><li>渐变的颜色不可以是带有透明通道的颜色，但由于这个方案本身就对背景颜色有明确的要求，所以这点可以间接规避。</li></ol><blockquote><ol start="2"><li>The color of the gradient cannot with alpha, but the good thing is that we explicitly require the background color, so this can be circumvented indirectly.</li></ol></blockquote><h2>小提示 Tip</h2><p>在复杂的图层中，你可以需要这个 css 属性：</p><blockquote><p>In complex layers, you can need this css property:</p></blockquote><pre class="language-css"><code class="language-css"><span class="token selector">.gradient-text-parent</span> <span class="token punctuation">{</span>
  <span class="token property">isolation</span><span class="token punctuation">:</span> isolate<span class="token punctuation">;</span>
<span class="token punctuation">}</span></code></pre></main></div><style>footer a{line-height:1}footer nav{display:flex;gap:1rem}</style><footer class="bg-ani"><nav><a target="_blank" href="https://github.com/gaubee/gaubee.com">Github</a> <a target="_blank" href="https://beian.miit.gov.cn/#/Integrated/recordQuery">闽ICP备17026139号-1</a></nav></footer></body></html>