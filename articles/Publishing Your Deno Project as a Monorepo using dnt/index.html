<!doctype html><html lang=zh-CN><meta charset=utf-8><title>Publishing Your Deno Project as a Monorepo using dnt · Gaubee</title><meta content="width=device-width" name=viewport><meta content="dark light" name=color-scheme><link href=/css/main.css rel=stylesheet><link href=/webmanifest.json rel=manifest><meta content=#ec407a name=theme-color><link href=/articles.atom rel=alternate title="Gaubee's Articles Atom feed" type=application/atom+xml><link href=/events.atom rel=alternate title="Gaubee's Events Atom feed" type=application/atom+xml><script>document.documentElement.className+=" js"</script><header id=header><h1><a href=/ >Gaubee</a></h1><a href=#navigation-toggle id=nav-toggle>显示导航 Show navigation</a><nav><ul><li><a href=/ >主页 Home</a><li class=current><a href=/articles>文章 Articles</a><li><a href=/events>小事件 Events</a></ul></nav></header><main id=main><article itemscope itemtype=http://schema.org/BlogPosting><header><h1 itemprop=headline>Publishing Your Deno Project as a Monorepo using dnt</h1><p class=meta>发布于 <time datetime=4/27/2024 itemprop=datePublished>4/27/2024</time> · 最后修改时间 <time datetime=4/27/2024 itemprop=dateModified>4/27/2024</time></header><div itemprop=articleBody><h2 id=publishing-your-deno-project-as-a-monorepo-using-dnt tabindex=-1><a href=#publishing-your-deno-project-as-a-monorepo-using-dnt class=header-anchor>Publishing Your Deno Project as a Monorepo using dnt</a></h2><blockquote><p>Before providing theoretical guidance, let's look at how to achieve this in practice. After completion, I will explain the advantages of this project management solution.</blockquote><h3 id=tools tabindex=-1><a href=#tools class=header-anchor>Tools</a></h3><ol><li><a href=https://deno.com/ >deno</a><li><a href=https://pnpm.io/installation>pnpm</a></ol><h3 id=preparation tabindex=-1><a href=#preparation class=header-anchor>Preparation</a></h3><ol><li><p>Create your project:<pre class=language-shell><code class=language-shell>deno init dnt-mono
<span class="token comment"># cd dnt-mono</span>
<span class="token comment"># code . # open in ide</span></code></pre><li><p>Initialize a git repository<pre class=language-shell><code class=language-shell><span class="token function">git</span> init
<span class="token builtin class-name">echo</span> <span class="token string">"npm<span class="token entity" title=\n>\n</span>node_modules"</span> <span class="token operator">></span> .gitignore <span class="token comment"># ignore the npm folder</span></code></pre><li><p>Initialize package.json, and other files typically required by npm/pnpm<pre class=language-shell><code class=language-shell><span class="token function">npm</span> init <span class="token parameter variable">--yes</span> <span class="token parameter variable">--private</span> <span class="token comment"># create a package.json file</span>
<span class="token builtin class-name">echo</span> <span class="token string">"MIT"</span> <span class="token operator">></span> LICENSE
<span class="token builtin class-name">echo</span> <span class="token string">"# Hello Dnt ❤️ Monorepo"</span> <span class="token operator">></span> README.md
<span class="token builtin class-name">echo</span> <span class="token string">"packages:<span class="token entity" title=\n>\n</span>  - <span class="token entity" title="\"">\"</span>npm/*<span class="token entity" title="\"">\"</span>"</span> <span class="token operator">></span> pnpm-workspace.yaml</code></pre><li><p>Prepare the dnt script<pre class=language-shell><code class=language-shell>deno <span class="token function">add</span> @deno/dnt</code></pre><p>Refer to <a href="https://github.com/denoland/dnt?tab=readme-ov-file#setup">Setup</a>, as we need to build multiple npm packages, create the <code>scripts/npmBuilder.ts</code> file:<pre class=language-ts><code class=language-ts><span class="token keyword">import</span> <span class="token punctuation">{</span> build<span class="token punctuation">,</span> BuildOptions<span class="token punctuation">,</span> emptyDir <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@deno/dnt"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> fs <span class="token keyword">from</span> <span class="token string">"node:fs"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> path <span class="token keyword">from</span> <span class="token string">"node:path"</span><span class="token punctuation">;</span>
<span class="token keyword">import</span> <span class="token punctuation">{</span> fileURLToPath <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"node:url"</span><span class="token punctuation">;</span>
<p><span class="token keyword">const</span> rootDir <span class="token operator">=</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">"../"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
<span class="token keyword">const</span> <span class="token function function-variable">rootResolve</span> <span class="token operator">=</span> <span class="token punctuation">(</span>path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token function">fileURLToPath</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> rootDir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function function-variable">npmBuilder</span> <span class="token operator">=</span> <span class="token keyword">async</span> <span class="token punctuation">(</span>config<span class="token operator">:</span> <span class="token punctuation">{</span><br>
packageDir<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>
version<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>
importMap<span class="token operator">?</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><br>
options<span class="token operator">?</span><span class="token operator">:</span> Partial<span class="token operator">&lt;</span>BuildOptions<span class="token operator">></span><span class="token punctuation">;</span><br>
<span class="token punctuation">}</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span><br>
<span class="token keyword">const</span> <span class="token punctuation">{</span> packageDir<span class="token punctuation">,</span> version<span class="token punctuation">,</span> importMap<span class="token punctuation">,</span> options <span class="token punctuation">}</span> <span class="token operator">=</span> config<span class="token punctuation">;</span><br>
<span class="token keyword">const</span> <span class="token function function-variable">packageResolve</span> <span class="token operator">=</span> <span class="token punctuation">(</span>path<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span><br>
<span class="token function">fileURLToPath</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name"><span class="token constant">URL</span></span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> packageDir<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
<span class="token keyword">const</span> packageJson <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><br>
fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span><span class="token function">packageResolve</span><span class="token punctuation">(</span><span class="token string">"./package.json"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"utf-8"</span><span class="token punctuation">)</span><br>
<span class="token punctuation">)</span><span class="token punctuation">;</span><br>
<span class="token comment">// remove some field which dnt will create. if you known how dnt work, you can keep them.</span><br>
<span class="token keyword">delete</span> packageJson<span class="token punctuation">.</span>main<span class="token punctuation">;</span><br>
<span class="token keyword">delete</span> packageJson<span class="token punctuation">.</span>module<span class="token punctuation">;</span><br>
<span class="token keyword">delete</span> packageJson<span class="token punctuation">.</span>exports<span class="token punctuation">;</span></p>
<p><span class="token builtin">console</span><span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string template-punctuation"><code>&lt;/span>&lt;span class="token string">\nstart dnt: &lt;/span>&lt;span class="token interpolation">&lt;span class="token interpolation-punctuation punctuation">${&lt;/span>packageJson&lt;span class="token punctuation">.&lt;/span>name&lt;span class="token interpolation-punctuation punctuation">}&lt;/span>&lt;/span>&lt;span class="token template-punctuation string"></code></span></span><span class="token punctuation">)</span><span class="token punctuation">;</span></p>
<p><span class="token keyword">const</span> npmDir <span class="token operator">=</span> <span class="token function">rootResolve</span><span class="token punctuation">(</span><span class="token template-string"><span class="token string template-punctuation"><code>&lt;/span>&lt;span class="token string">./npm/&lt;/span>&lt;span class="token interpolation">&lt;span class="token interpolation-punctuation punctuation">${&lt;/span>packageJson&lt;span class="token punctuation">.&lt;/span>name&lt;span class="token punctuation">.&lt;/span>&lt;span class="token function">split&lt;/span>&lt;span class="token punctuation">(&lt;/span>&lt;span class="token string">"/"&lt;/span>&lt;span class="token punctuation">)&lt;/span>&lt;span class="token punctuation">.&lt;/span>&lt;span class="token function">pop&lt;/span>&lt;span class="token punctuation">(&lt;/span>&lt;span class="token punctuation">)&lt;/span>&lt;span class="token interpolation-punctuation punctuation">}&lt;/span>&lt;/span>&lt;span class="token template-punctuation string"></code></span></span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
<span class="token keyword">const</span> <span class="token function function-variable">npmResolve</span> <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">)</span> <span class="token operator">=></span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>npmDir<span class="token punctuation">,</span> p<span class="token punctuation">)</span><span class="token punctuation">;</span></p>
<p><span class="token keyword">await</span> <span class="token function">emptyDir</span><span class="token punctuation">(</span>npmDir<span class="token punctuation">)</span><span class="token punctuation">;</span></p>
<p><span class="token keyword">if</span> <span class="token punctuation">(</span>version<span class="token punctuation">)</span> <span class="token punctuation">{</span><br>
Object<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span>packageJson<span class="token punctuation">,</span> <span class="token punctuation">{</span> version<span class="token operator">:</span> version <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
<span class="token punctuation">}</span></p>
<p><span class="token keyword">await</span> <span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>
entryPoints<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">"."</span><span class="token punctuation">,</span> path<span class="token operator">:</span> <span class="token function">packageResolve</span><span class="token punctuation">(</span><span class="token string">"./index.ts"</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>
outDir<span class="token operator">:</span> npmDir<span class="token punctuation">,</span><br>
packageManager<span class="token operator">:</span> <span class="token string">"pnpm"</span><span class="token punctuation">,</span><br>
shims<span class="token operator">:</span> <span class="token punctuation">{</span><br>
deno<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>
<span class="token punctuation">}</span><span class="token punctuation">,</span><br>
<span class="token comment">// you should open it in actual</span><br>
test<span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span><br>
importMap<span class="token operator">:</span> importMap<span class="token punctuation">,</span><br>
<span class="token keyword">package</span><span class="token operator">:</span> packageJson<span class="token punctuation">,</span><br>
<span class="token comment">// custom by yourself</span><br>
compilerOptions<span class="token operator">:</span> <span class="token punctuation">{</span><br>
lib<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"DOM"</span><span class="token punctuation">,</span> <span class="token string">"ES2022"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><br>
target<span class="token operator">:</span> <span class="token string">"ES2022"</span><span class="token punctuation">,</span><br>
emitDecoratorMetadata<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><br>
<span class="token punctuation">}</span><span class="token punctuation">,</span><br>
<span class="token function">postBuild</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span><br>
<span class="token comment">// steps to run after building and before running the tests</span><br>
Deno<span class="token punctuation">.</span><span class="token function">copyFileSync</span><span class="token punctuation">(</span><span class="token function">rootResolve</span><span class="token punctuation">(</span><span class="token string">"./LICENSE"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token function">npmResolve</span><span class="token punctuation">(</span><span class="token string">"./LICENSE"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
Deno<span class="token punctuation">.</span><span class="token function">copyFileSync</span><span class="token punctuation">(</span><br>
<span class="token function">packageResolve</span><span class="token punctuation">(</span><span class="token string">"./README.md"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>
<span class="token function">npmResolve</span><span class="token punctuation">(</span><span class="token string">"./README.md"</span><span class="token punctuation">)</span><br>
<span class="token punctuation">)</span><span class="token punctuation">;</span><br>
<span class="token punctuation">}</span><span class="token punctuation">,</span><br>
<span class="token operator">...</span>options<span class="token punctuation">,</span><br>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre><p></ol><h3 id=main-steps tabindex=-1><a href=#main-steps class=header-anchor>Main Steps</a></h3><ol><li><p>Create two subfolders and add some project files<pre class=language-shell><code class=language-shell><span class="token comment"># start from root</span>
<span class="token function">mkdir</span> packages/module-a
<span class="token builtin class-name">cd</span> packages/module-a
<span class="token builtin class-name">echo</span> <span class="token string">"export const a = 1;"</span> <span class="token operator">></span> index.ts
<span class="token builtin class-name">echo</span> <span class="token string">"# @dnt-mono/module-a"</span> <span class="token operator">></span> README.md
<span class="token function">npm</span> init <span class="token parameter variable">--scope</span> @dnt-mono <span class="token parameter variable">--yes</span> <span class="token comment"># name: @dnt-mono/module-a</span></code></pre><p>Repeat the steps to create a <code>module-b</code> folder<pre class=language-shell><code class=language-shell><span class="token comment"># start from root</span>
<span class="token function">mkdir</span> packages/module-b
<span class="token builtin class-name">cd</span> packages/module-b
<span class="token builtin class-name">echo</span> <span class="token string">"import { a } from <span class="token entity" title="\"">\"</span>@dnt-mono/module-a<span class="token entity" title="\"">\"</span>;<span class="token entity" title=\n>\n</span>export const b = a + 1;"</span> <span class="token operator">></span> index.ts
<span class="token builtin class-name">echo</span> <span class="token string">"# @dnt-mono/module-b"</span> <span class="token operator">></span> README.md
<span class="token function">npm</span> init <span class="token parameter variable">--scope</span> @dnt-mono <span class="token parameter variable">--yes</span> <span class="token comment"># name: @dnt-mono/module-b</span>
<p><span class="token function">pnpm</span> <span class="token function">add</span> @dnt-mono/module-a <span class="token parameter variable">--workspace</span> <span class="token comment"># add module-a as a dependency</span></code></pre><p><li><p>In this example, <code>module-b</code> depends on <code>module-a</code>, and we used the specifier <code>@dnt-mono/module-a</code> in the code, so we need some configurations to make the deno language server work correctly. In the <code>imports</code> field of <code>deno.json</code>, add these configurations:<pre class=language-jsonc><code class=language-jsonc> "@dnt-mono/module-a": "./packages/module-a/index.ts", // in imports
 "@dnt-mono/module-b": "./packages/module-b/index.ts" // in imports</code></pre><li><p>Next, create the build script and configuration files<ol><li><p><code>scripts/build_npm.ts</code><pre class=language-ts><code class=language-ts><span class="token keyword">import</span> <span class="token punctuation">{</span> npmBuilder <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"./npmBuilder.ts"</span><span class="token punctuation">;</span>
<p><span class="token keyword">const</span> version <span class="token operator">=</span> Deno<span class="token punctuation">.</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">;</span><br>
<span class="token keyword">await</span> <span class="token function">npmBuilder</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>
packageDir<span class="token operator">:</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">"../packages/module-a/"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>
importMap<span class="token operator">:</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">"./import_map.npm.json"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>
version<span class="token punctuation">,</span><br>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br>
<span class="token keyword">await</span> <span class="token function">npmBuilder</span><span class="token punctuation">(</span><span class="token punctuation">{</span><br>
packageDir<span class="token operator">:</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">"../packages/module-b/"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>
importMap<span class="token operator">:</span> <span class="token keyword">import</span><span class="token punctuation">.</span>meta<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span><span class="token string">"./import_map.npm.json"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>
version<span class="token punctuation">,</span><br>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p><li><p><code>scripts/import_map.npm.json</code><pre class=language-json><code class=language-json><span class="token punctuation">{</span>
  <span class="token property">"imports"</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">"@dnt-mono/module-a"</span><span class="token operator">:</span> <span class="token string">"npm:@dnt-mono/module-a"</span><span class="token punctuation">,</span>
    <span class="token property">"@dnt-mono/module-b"</span><span class="token operator">:</span> <span class="token string">"npm:@dnt-mono/module-b"</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span></code></pre></ol><li><p>Then, in your <code>deno.json</code>, configure the build command:<pre class=language-jsonc><code class=language-jsonc>"build": "deno run -A ./scripts/build_npm.ts" // in tasks</code></pre><li><p>Finally, try executing the build command to create the npm directory<pre class=language-shell><code class=language-shell>deno task build</code></pre><p>Now, you should see the npm directory has been populated with the module-a and module-b folders ready for npm publishing.<br>You can try to publish these npm packages:<pre class=language-shell><code class=language-shell><span class="token function">pnpm</span> publish <span class="token parameter variable">-r</span> --no-git-checks --dry-run <span class="token comment"># you should remove --dry-run for an actual run</span></code></pre></ol><h3 id=how-it-works tabindex=-1><a href=#how-it-works class=header-anchor>How It Works</a></h3><ol><li>We use deno as the language server, which is quite powerful, vastly improved from tsc itself through customized development.<li>So here, the package.json is just a "template file" and not a configuration file. The only configuration file that goes into effect during development is deno.json.<li>Hence, pnpm is just a tool for the final output built by dnt, meaning it only serves the <code>npm/*</code> directory. This is also why <code>pnpm-workspaces.yaml</code> is configured as it is.<li>The <code>import_map.npm.json</code> used in dnt is essential. We can't use <code>deno.json</code> directly as <code>importMap</code> because <code>deno.json</code> is configured for the deno language server, while <code>import_map.npm.json</code> is for dnt/pnpm use. In complex projects, it's advisable to manage it automatically with a script.</ol><h3 id=advanced-tips tabindex=-1><a href=#advanced-tips class=header-anchor>Advanced Tips</a></h3><p>In deno development, our philosophy is file-oriented rather than module-oriented. Therefore, if needed, you may want to add this kind of configuration in <code>deno.json</code>:<pre class=language-jsonc><code class=language-jsonc>{
  // ...
  "imports": {
    // ...
    "@dnt-mono/module-a": "./packages/module-a/index.ts",
    "@dnt-mono/module-a/": "./packages/module-a/src/",
    "@dnt-mono/module-b": "./packages/module-b/index.ts",
    "@dnt-mono/module-b/": "./packages/module-b/src/"
    // ...
  }
}</code></pre><p>I prefer to put files other than <code>index.ts</code> into a <code>src</code> directory, which aligns more with the style of node projects.<blockquote><p>However, remember not to move the <code>index.ts</code> file to the <code>src</code> directory as well, as it could cause exceptions <a href=https://github.com/denoland/dnt/issues/249>#249</a>.</blockquote><p>Then, it's about the dnt configuration, where you need to iterate over all your files and configure them in the entryPoints:<pre class=language-ts><code class=language-ts><span class="token function">build</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  entryPoints<span class="token operator">:</span> <span class="token punctuation">[</span>
    <span class="token comment">// default entry</span>
    <span class="token punctuation">{</span> name<span class="token operator">:</span> <span class="token string">"."</span><span class="token punctuation">,</span> path<span class="token operator">:</span> <span class="token function">packageResolve</span><span class="token punctuation">(</span><span class="token string">"./index.ts"</span><span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token comment">// src files</span>
    <span class="token constant">ALL_SRC_TS_FILES</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span>name<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>
      name<span class="token operator">:</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string">./</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>name<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string template-punctuation">`</span></span><span class="token punctuation">,</span>
      path<span class="token operator">:</span> <span class="token template-string"><span class="token string template-punctuation">`</span><span class="token string">./src/</span><span class="token interpolation"><span class="token punctuation interpolation-punctuation">${</span>name<span class="token punctuation interpolation-punctuation">}</span></span><span class="token string template-punctuation">`</span></span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token comment">// ...</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre><p>Now, you can write code like this:<pre class=language-ts><code class=language-ts><span class="token keyword">import</span> <span class="token punctuation">{</span> xxx <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@dnt-mono/module-a/xxx.ts"</span><span class="token punctuation">;</span></code></pre><h3 id=points-to-note tabindex=-1><a href=#points-to-note class=header-anchor>Points to Note</a></h3><ol><li>Plan your project structure well to avoid cyclic dependencies. If needed, you should configure peerDependencies yourself.<li>Don't self-import within a module.<blockquote><p>The language server doesn't understand that you intend to publish to npm, so even if deno works correctly, your goal is to make it work with node as well.</blockquote><pre class=language-ts><code class=language-ts><span class="token keyword">import</span> <span class="token punctuation">{</span> a <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">"@dnt-mono/module-a"</span><span class="token punctuation">;</span> <span class="token comment">// don't import module-a in module-a</span></code></pre>It is advisable to write lint rules to avoid these mistakes in actual projects.</ol></div><footer></footer></article></main><footer id=footer><div><nav><a href=https://twitter.com/gaubeebangeel rel="me nofollow" target=_blank>Twitter</a> · <a href="https://github.com/gaubee/gaubee.com/tree/main/./src/articles/Publishing Your Deno Project as a Monorepo using dnt.md" rel=nofollow target=_blank>Edit this page on GitHub</a></nav><dark-mode-toggle dark="Light Theme" light="Dark Theme" permanent></dark-mode-toggle></div><p><small>除非有特别的说明, 该站点所有直接内容都使用许可证：<a href=https://creativecommons.org/licenses/by/4.0/deed.zh>署名 4.0 国际 (CC BY 4.0)</a></small><blockquote><small>本网站不收集任何访问者的行为与信息，不做任何商业运作，仅仅为个人使用</small> <small style=display:block><a href=https://beian.mps.gov.cn/#/query/webSearch>闽ICP备17026139号-1</a></small></blockquote></footer><script src=/js/dark-mode-toggle.mjs type=module></script><script src=/js/time-elements.mjs type=module></script><script src=/js/main.mjs type=module></script>