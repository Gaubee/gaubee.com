# TODO List

本文件用于追踪博客系统的开发任务。

## 第一阶段：UI/UX 美化 (已完成)

- [x] 使用三栏式布局重新设计首页。
- [x] 使用两栏式布局重新设计文章详情页。
- [x] 为文章实现自动生成目录（TOC）的功能。
- [x] 重新设计“短评”详情页。
- [x] 添加页面切换动画（View Transitions）。

## 第二阶段：侧边栏功能实现 (已完成)

- [x] **基于标签的分类导航**
- [x] **基于日期的归档导航**
- [x] **搜索功能 (采纳 minisearch 方案)**

## 第三阶段：体验优化与技术栈升级 (进行中)

### 第二阶段：体验深度优化（进行中）

- [x] **搜索体验优化**:
  - [x] 在搜索结果中高亮显示匹配的关键词。
  - [x] 优化 `minisearch` 的模糊搜索和权重配置，提高结果相关性。
- [x] **技术栈升级**:
  - [x] 引入 `tailwindcss-v4` 进行样式开发。
  - [x] 引入 `magicui` 和 `shadcn/ui` 来优化组件，提升UI体验。
- [x] **搜索体验优化 (锦上添花)**:
  - [x] 为搜索弹窗添加更精美的 UI 和过渡动画。
- [x] **优化响应式布局**:
  - [x] 解决文章详情页等页面在某些情况下宽度撑满的问题。
  - [x] 事件详情页使用和文章详情页一样的布局方案。不一样的是，右边不是文章目录，而是“上一篇”和“下一篇”
  - [x] 移动设备状态下（就是说右边部分无法显示的情况下），顶部应该出现一个topbar，topbar的左边就是一个“返回”按钮，右边就是一个展开按钮，可以将右边部分用抽屉的模式打开。
  - [x] 右侧的目录部分，应该随着滚动而高亮当前所处的章节
  - [x] 随着滚动，应该出现一个“回到顶部的按钮”，这个按钮位置的设计要合理，要考虑内容遮挡的问题。
- [ ] “事件” 统一改名成 “时事快讯”，重点强调时间相关的快讯讨论。
- [ ] 写一个AI脚本能为“文章”或者“时事快讯”搜罗一些相关免费的封面图片。
- [ ] **增强视图过渡 (ViewTransition)**:
  - [ ] 配置共享元素（Shared Element）过渡，优化动画体验，避免单纯的淡入淡出。
- [ ] 集成 [`streamdown`](https://github.com/vercel/streamdown)，统一渲染方案
  > 用于流式渲染 Markdown 片段。并且内置集成了各种常用Markdown扩展组件
  - 同时我希望得到更好的内容样式效果：内容的行高、留白都应该更加专业。现在的效果只是内容渲染出来了，但是样式令人感觉很粗糙。至少应该达到github-markdown那种阅读友好的效果
- [ ] **优化首页内容展示**:
  - [ ] 对于“文章”或者“时事快讯”，在首页卡片中截取并渲染前 3-8 行非空行的内容。
    > 首先依赖于streamdown的流式，可以优雅处理不完整的 Markdown。这对我们后续的截断渲染的功能打下基础。
    > 8行是一个max-height的概念。如果内容在max-height能够完全显示，那么就完全渲染出来。3行是一个min-height的概念，就是min-height的部分至少是要清晰渲染。
    > 如果溢出了max-height，那么就要加入一个底部雾化的效果，来让用户知道这里不止8行。
    > 所以我们首先基于换行符的分析来截取markdown内容，如果不止8行，那么预览卡片的底部就是直接雾化效果。
    > 如果8行以内，那么就在max-height的高度内去尝试完全渲染，如果没有溢出max-height，那么就完整清晰地显示。如果溢出了max-height，那么仍然要底部雾化。
    > 我们需要将这个封装成“markdown预览”卡片，可以预览各种内容。
    > 这个markdown预览卡片还需要支持“封面图片”。封面图片通常是直接从markdown的内容中提取而来，但是不一样的是，它不是直接按照顺序渲染markdown图片，而是将markdown图片提取出来，作为卡片的头部。如果有多张图片，那么就使用网格布局去渲染这些图片，最多可以组合成9宫格。
    > 还有，卡片的时间展示，应该有本地化的时间风格。现在是固定的英语时间，这不对。
- [ ] 使用 Lucide React 来统一所有的图标需求。

- [ ] **代码质量重构**:
  - [x] 将 `RightSidebar.tsx` 拆分为独立的、可复用的卡片组件 (`TableOfContentsCard`, `TagsCard`, `ArchiveCard`)。
  - [x] 重构 `MobileTopbar.tsx`，将其与 `Sheet` 组件解耦，提升其复用性。
  - [x] 将 `AppLayout.astro` 重命名为 `ContentLayout.astro`，使其名称更准确地反映其用途。

## 第四阶段：后台管理功能 (已完成)

- [x] 调研纯前端的 Git 客户端和基于 IndexedDB 的文件系统解决方案。
- [x] 设计并实现管理员界面的 UI。
- [x] 实现文件操作（创建、编辑、删除）。
- [x] 使用 GitHub API 在前端实现 Git 操作（commit, push）。
- [x] 集成一个高质量的 Markdown 编辑器。
- [x] **优化 Markdown 编辑器体验**:
  - [x] 为元数据（Frontmatter）提供专门的表单编辑 UI。
  - [x] 支持在可视化和原始 Markdown 模式之间切换。
