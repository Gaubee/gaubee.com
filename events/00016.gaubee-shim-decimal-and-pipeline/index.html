<!doctype html><html><head><meta charset="utf-8"><meta name="description" content=""><meta name="keywords" content="Appn, WebComponent, event"><meta name="author" content="Gaubee, gaubeebangeel@gmail.com"><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=5"><title>undefined</title><link rel="shortcut icon" href="/assets/favicon-wB3RD3gX.ico"><link rel="stylesheet" href="/index.css">  <link rel="stylesheet" crossorigin href="/assets/prism-okaidia-D95GE6Gn.css">
<link rel="manifest" href="/manifest.webmanifest"><script id="vite-plugin-pwa:register-sw" src="/registerSW.js"></script></head><body><header class="bg-ani"><style>.nav{padding:0 2em;border-radius:2em;backdrop-filter:contrast(0.5) brightness(2);width:fit-content;max-width:100%}.nav{display:grid;grid-template-columns:repeat(auto-fit,180px);justify-content:center;gap:12px}.nav>a{display:block;flex:1;font-size:18px;padding:16px;text-align:center}.nav>a{color:#e91e63}@supports (-webkit-background-clip:text){.nav>a{background:-webkit-linear-gradient(#e91e63,#673ab7);color:transparent;-webkit-background-clip:text;-webkit-text-fill-color:transparent}}</style><nav class="nav"><a class="" href="/">Home</a> <a class="" href="/articles/">Articles</a> <a class="target" href="/events/">Events</a> <a class="" href="/timeline/">Timeline</a> <a class="" href="/projects/">Projects</a></nav></header><div id="main-wrapper" class="event-wrapper"><main><p>这两天我搞了 @gaubee/shim 这个包，主要是基于现有的 tc39 提案做的一些垫片，但不是polyfill，这个包仍然是“无副作用”的，追求对Tree-Shaking的最佳支持。 目前提供两部分的功能。</p><ol><li>@gaubee/shim/decimal<ul><li>基于big.js做的ts+fp（类型安全+函数式编程）化的改造。</li><li>单元测试我也完全搬过来了，并且做了一些优化，理论上性能会比big.js更好，但我没具体去测试。</li><li>可能是目前是最小的的 big-float 包了，因为它只包含了最基本的 parse+stringify(toString/valueOf)的能力（本质就是拆包和封包，起步200行左右的注释和代码）。</li></ul></li></ol><p>但因为是fp编程的风格，而不是链式调用，所以用起来会比较麻烦， 比如big.js是这样的：new Big('12.345').round(2).toString() 而decimal就得这样：decimal_toString(decimal_round(decimal('12.345'),2))</p><p>所以就有了pipeline这个功能：</p><ol start="2"><li>@gaubee/shim/pipeline<ul><li>也是参考了tc39的pipeline提案，用法非常简单：<pre class="language-ts"><code class="language-ts"><span class="token function">pipeline</span><span class="token punctuation">(</span><span class="token punctuation">[</span>
  <span class="token comment">//</span>
  <span class="token punctuation">[</span>decimal<span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>decimal_round<span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
  <span class="token punctuation">[</span>decimal_toString<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token string">'12.345'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li><li>就是把前面一个函数的返回结果作为下一个函数的第一个参数。</li><li>我在市面上没找到类型安全的实现，所以就自己和AI做了一套，主要是做类型比较麻烦。但js核心代码也就一两行。</li></ul></li></ol></main></div><style>footer a{line-height:1}footer nav{display:flex;gap:1rem}</style><footer class="bg-ani"><nav><a target="_blank" href="https://github.com/gaubee/gaubee.com">Github</a> <a target="_blank" href="https://beian.miit.gov.cn/#/Integrated/recordQuery">闽ICP备17026139号-1</a></nav></footer></body></html>