<!doctype html><html><head><meta charset="utf-8"><meta name="description" content=""><meta name="keywords" content="Appn, WebComponent, event"><meta name="author" content="Gaubee, gaubeebangeel@gmail.com"><meta name="viewport" content="width=device-width,initial-scale=1,minimum-scale=1,maximum-scale=5"><title>undefined</title><link rel="shortcut icon" href="/assets/favicon-wB3RD3gX.ico"><link rel="stylesheet" href="/index.css">  <link rel="stylesheet" crossorigin href="/assets/prism-okaidia-D95GE6Gn.css">
</head><body><header class="bg-ani"><style>.nav{padding:0 2em;border-radius:2em;backdrop-filter:contrast(0.5) brightness(2);width:fit-content;max-width:100%}.nav{display:grid;grid-template-columns:repeat(auto-fit,180px);justify-content:center;gap:12px}.nav>a{display:block;flex:1;font-size:18px;padding:16px;text-align:center}.nav>a{color:#e91e63}@supports (-webkit-background-clip:text){.nav>a{background:-webkit-linear-gradient(#e91e63,#673ab7);color:transparent;-webkit-background-clip:text;-webkit-text-fill-color:transparent}}</style><nav class="nav"><a class="" href="/">Home</a> <a class="" href="/articles/">Articles</a> <a class="target" href="/events/">Events</a> <a class="" href="/timeline/">Timeline</a> <a class="" href="/projects/">Projects</a></nav></header><div id="main-wrapper" class="event-wrapper"><main><p><code>@gaubee/util</code> 包中的 delay 函数，相比于市面上的 delay 函数，有着很特别的能力，就是它不仅仅是可以传递一个数字（毫秒），还可以传递一个 timmer 对象。</p><p>以下是详细的能力介绍：</p><ol><li><code>delay(0)</code> 0 毫秒，那么它不会使用 setTimeout 来计时，而是会使用 queueMicrotask 来创建延迟队列。然而你知道 await 关键词本身就是在创建一个 queueMicrotask 队列，不同的是，<code>const delayer = delay(0)</code> 这里的 delayer 对象是可以进行取消的 <code>delayer.cancel(reason?)</code>。</li><li><code>delay(10)</code> 等同于 setTimeout/clearTimeout</li><li><code>delay(timmers.raf)</code> 等同于 requestAnimationFrame/cancelAnimationFrame</li><li><code>delay(timmers.eventTarget&lt;AnyEvent&gt;(window,'scrollend'))</code> 等同于 addEventListener/removeEventListener（浏览器 EventTarget）</li><li><code>delay(timmers.eventEmitter&lt;AnyArgs&gt;(event,'scrollend'))</code> 等同于 addEventListener/removeEventListener（nodejs 的 EventEmitter）</li><li><code>delay(pureEvent&lt;AnyType&gt;().once);</code> 可以将一个 pureEvent 的 once 函数直接传递进去</li><li>你可以可以完全自定义什么时候进行 resolve，并返回解构函数：<pre class="language-ts"><code class="language-ts"><span class="token function">delay</span><span class="token punctuation">(</span><span class="token punctuation">(</span>resolve<span class="token punctuation">,</span> reject<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>
  some<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span>resolve<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> some<span class="token punctuation">.</span><span class="token function">off</span><span class="token punctuation">(</span>resolve<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre></li></ol></main></div><style>footer a{line-height:1}footer nav{display:flex;gap:1rem}</style><footer class="bg-ani"><nav><a target="_blank" href="https://github.com/gaubee/gaubee.com">Github</a> <a target="_blank" href="https://beian.miit.gov.cn/#/Integrated/recordQuery">闽ICP备17026139号-1</a></nav></footer></body></html>